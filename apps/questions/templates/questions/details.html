{% extends 'partials/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'assets/fancybox/jquery.fancybox.min.css' %}">
<link rel="stylesheet" href="{% static 'assets/css/pages/comments/comment-comments.css' %}" />
{% endblock extra_css%}

{% block content %}
<!-- Main Content -->
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8 mb-4">
           <button type="button" onclick="history.back()" class="btn btn-sm btn-label-primary rounded-pill waves-effect">
           <span class="ti-xs ti ti-chevron-left me-2"></span>Geri Dön
           </button>
        </div>
     </div>

    <div class="row justify-content-center">
        <div class="col-md-8">
            <!-- Question Details -->
            <div class="card mb-4">
                <div class="card-body">
                    <h1 class="card-title mb-0">{{data.title}}</h1>
                    <small class="card-text text-muted">Category: {{data.category}}  | {{data.create_at}}</small>
                    
                    <p>{{ data.content|safe }}</p>
                    
                    <div class="d-flex justify-content-between align-items-center mt-4">
                        <div class="text-muted">
                            <div class="d-flex align-items-center">
                                {% if data.user.profilepicturemodel.profile_photo %}
                                {% with profile_photo_url=data.user.profilepicturemodel.profile_photo.url %}
                                <div class="avatar me-2">
                                    <img src="{{ profile_photo_url }}" alt="Yazar Profil Fotoğrafı" class="rounded-circle me-2">
                                </div>
                                {% endwith %}
                                {% else %}
                                <div class="avatar avatar-xs me-2">
                                    <img src="{% static 'assets/img/avatars/11.png' %}" alt="Yazar Profil Fotoğrafı" class="rounded-circle me-2" style="width: 40px; height: 40px;">
                                </div>
                                {% endif %}
                                <div>
                                   <small>{{ data.user.first_name }} {{ data.user.last_name }}</small>
                                   <div>
                                    <small>{{data.user.educationalinformationmodel.University}}</small>
                                 </div>
                                </div>
                             </div>

                        </div>
                        <div>
                            <a href="javascript:void(0);" class="text-body me-3 like-btn" data-content-type-id="{{data.likes.content_type.id}}" data-object-id="{{data.id}}">
                                <i class="ti ti-heart{% if data.id in liked %}-filled{% endif %}"></i>
                                <span class="like-count text-body">{{ data.likes.count }}</span>
                                </a>
                                <i class="ti ti-message-plus me-1"></i> {{ data.comments.count }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
   <!-- Yorum Formu -->
   <div class="row justify-content-center mt-4">
    <div class="col-lg-8">
       <!-- Comment Form -->
       {% block comment-form %}
       {% include 'comments/form-comment.html' %}
       {% endblock comment-form %}
       <!-- End Comment Form -->
    </div>
 </div>
 <div class="row justify-content-center">
    <div class="col-lg-8">
       <h4 class="fw-bold mb-0">Cevaplar ({{data.comments.count}})</h4>
    </div>
 </div>
 <div class="row justify-content-center mt-4">
    <div class="col-lg-8">
       <!-- Comments -->
       {% for comment in comments %}
       {% block comment %}
       {% include 'comments/comments.html' %}
       {% endblock comment %}
       {% endfor %}
       <!-- End Comments -->
    </div>
 </div>

</div>

{% endblock content %}

{% block extra_javascript %}
<script src="{% static 'assets/fancybox/jquery.fancybox.min.js' %}"></script>
<script src="{% static 'assets/js/pages/comments/comment-comments.js' %}"></script>
<script src="{% static 'assets/js/pages/likes/like.js' %}"></script>
{% endblock extra_javascript %}

