{% extends 'partials/base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'assets/css/pages/comments/comment-comments.css' %}" />

{% endblock extra_css%}

{% block content %}


<div class="container my-5">

    <div class="row">
        <div class="col-lg-8">
            <div class="mb-4">
                <div class="card">
                    <div class="card-body">
                <h1 class="mb-0">{{ document.title }}</h1>

                <p><strong>Folder:</strong> 
                    <a href="">
                        {{ document.folder.name }}
                    </a>
                </p>
                <p>{{ document.content|safe }}</p>

                <div class="d-flex justify-content-between align-items-center mt-4">
                    <div class="text-muted">
                        <div class="d-flex align-items-center">
                            {% if document.user.profilepicturemodel.profile_photo %}
                            {% with profile_photo_url=document.user.profilepicturemodel.profile_photo.url %}
                            <div class="avatar me-2">
                                <img src="{{ profile_photo_url }}" alt="Yazar Profil Fotoğrafı" class="rounded-circle me-2">
                            </div>
                            {% endwith %}
                            {% else %}
                            <div class="avatar avatar-xs me-2">
                                <img src="{% static 'assets/img/avatars/11.png' %}" alt="Yazar Profil Fotoğrafı" class="rounded-circle me-2" style="width: 40px; height: 40px;">
                            </div>
                            {% endif %}
                            <div>
                               <small>{{ document.user.first_name }} {{ document.user.last_name }}</small>
                               <div>
                                <small>{{document.user.educationalinformationmodel.University}}</small>
                             </div>
                            </div>
                         </div>

                    </div>
                    <div>
                        <a href="javascript:void(0);" class="text-body me-3 like-btn" data-content-type-id="{{document.likes.content_type.id}}" data-object-id="{{document.id}}">
                            <i class="ti ti-heart{% if document.id in liked %}-filled{% endif %}"></i>
                            <span class="like-count text-body">{{ document.likes.count }}</span>
                            </a>
                            <i class="ti ti-message-plus me-1"></i> {{ document.comments.count }}
                    </div>
                </div>


                </div>
            </div>
            </div>

            <!-- <div class="document-viewer mb-4">
                <iframe src="{{ document.file.url }}#toolbar=0" allowfullscreen></iframe>
            </div> -->
        </div>
        <div class="col-lg-4">
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Document Details</h5>
                    <p><strong>Folder:</strong> 
                        <a href="">
                            {{ document.folder.name }}
                        </a>
                    </p>
                    <p><strong>Documents in Folder:</strong> {{ document.folder.documents.count }}</p>
                    <a href="{{ document.file.url }}" class="btn btn-outline-primary" download>
                        <i class="bi bi-download"></i> Download Document
                    </a>
                </div>
            </div>
        </div>
    </div>
       <!-- Yorum Formu -->
   <div class="row">
    <div class="col-lg-8">
       <!-- Comment Form -->
       {% block comment-form %}
       {% include 'comments/form-comment.html' %}
       {% endblock comment-form %}
       <!-- End Comment Form -->
    </div>
 </div>
 <div class="row">
    <div class="col-lg-8">
       <h4 class="fw-bold mb-0">Yorumlar ({{document.comments.count}})</h4>
    </div>
 </div>
 <div class="row mt-4">
    <div class="col-lg-8">
       <!-- Comments -->
       {% for comment in comments %}
       {% block comment %}
       {% include 'comments/comments.html' %}
       {% endblock comment %}
       {% endfor %}
       <!-- End Comments -->
    </div>
 </div>
</div>




{% endblock content %}

{% block extra_javascript %}
<script src="{% static 'assets/js/pages/comments/comment-comments.js' %}"></script>
<script src="{% static 'assets/js/pages/likes/like.js' %}"></script>
{% endblock extra_javascript %}

